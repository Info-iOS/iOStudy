# 4/14 (금) 요약

# SceneDelegate

- SceneDelegate은 화면에 무엇을 보여줄지 관리하는 역할을 한다.

### **scene(_: willConnectTo: options: )**

- 제일 처음 불리는 메소드로  첫 content view, 새로운 UIWindow를 생성하고 window의rootViewController를 설정한다.

### **sceneWillEnterForeground(_ :)**

- scene이 foreground로 전환될 때 불린다. 두 가지 경우가 있는데 background → foreground로 바뀔때나 처음 active일때가 있다.

### **sceneDidBecomeActive(_ :)**

- scene이 setup 되고 화면에 보여지면서 사용 될 준비가 완료 된 상태이다. inactive → active로 전환 될 때도 불린다

### **sceneWillResignActive(_ :)**

- active한 상태에서 inactive 상태로 들어갈 때 불리는데 핸드폰 사용 중 전화가 걸려오는 것 처럼 임시 interruption 때문에 발생할 수 있다.

### **sceneDidEnterBackground(_ :)**

- scene이 다시 foreground에서 background로 전환 될 때 불리게 되므로 다음에 다시 foreground에 돌아 올 때 복원할 수 있도록 정보를 저장하거나, 데이터를 저장, 공유 자원 돌려주는 등의 일을 하도록 하면 된다.

### **sceneDidDisconnect(_ :)**

- 이 메소드 내에서 해야 할 중요한 작업은 필요 없는 자원은 돌려주는 것입니다.

# ARC

### Auto ****Reference Counting****

쉽게 직역하면 자동 참조 카운팅이다. 참조를 카운팅하는 이유는 메모리를 관리하기 위함이다.

자동으로 메모리 관리를 하는 것은 편리하게 사용하기 위함이다.

컴파일러가 자동으로 메모리 관리 코드를 넣어주고 코드도 훨씬 짧아지고, 자연스럽게 프로그램의 안정성을 높일 수 있게 된다.

### 장점

컴파일 당시 이미 인스턴스의 해제 시점이 정해져 있어서 인스턴스가 언제 메모리에서 해제될지 예측 가능함

### 단점

작동 규칙을 모르고 사용하면 인스턴스가 메모리에서 영원히 해제되지 않을 가능성이 있다.

### 규칙

자동으로 메모리 관리를 받기 위해서는 몇 가지 규칙을 알아야 한다. 왜냐 ARC는 컴파일과 동시에 인스턴스를 메모리에서 해제하는 시점이 결정하기 때문. 원하는 용도로 사용하려면 ARC에 명확한 힌트를 주어야 한다.

클래스의 인스턴스를 생성할 때마다 ARC는 그 인스턴스에 대한 정보를 저장하기 위한 메모리 공간을 따로 또 할당한다.

# 순환참조

순환 참조란 두 가지 이상의 객체가 서로에 대한 강한 참조 상태를 가지고 있을 때 발생하며, 순환 참조가 발생하게 되면 서로에 대한 참조가 해제되지 않기 때문에 메모리에서 유지되며 이로 인해 메모리 릭이 발생하게 된다.

메모리릭은 개발자가 의도하지 않은 메모리를 점유하고 있는 현상을 말한다.

### 순환참조 해결 방법

순환 참조를 해결하기 위해 weak, unowned reference가 사용된다.

약한 참조를 사용하여 해결할 수 있다.

```swift
class A {
    weak var b: B?
}

class B {
    var a: A?
}

// A와 B 인스턴스 생성
var instanceA: A? = A()
var instanceB: B? = B()

// 강한 참조 사이클 형성
instanceA?.b = instanceB
instanceB?.a = instanceA

// 참조 해제
instanceA = nil
instanceB = nil
```

클래스 A는 클래스 B를 약한참조로 참조 하도록 했고. 참조 대상이 메모리에서 해제되면 자동으로 nil값을 할당하므로, 강한 참조 사이클이 형성되어도 메모리 누수 문제를 방지할 수 있다.

# 모나드

모나드는 여러 영역에서 다양한 뜻을 가지기도 하고 한 문장으로 설명하기 어려운 개념이다. 프로그래밍에서의 모나드를 모나딕이라고 표현한다. 그래서 모나드의 성질을 갖는 타입이나 함수를 모나딕 타입 혹은 모나딕 함수등으로 표현한다.

### 모나드가 갖춰야 하는 조건

- 타입을 인자로 받는 타입
- 특정 타입의 값을 포장한 것을 반환하는 함수가 존재
- 포장한 값을 변환하여 같은 형태로 포장하는 함수가 존재

### 컨텍스트

이번 파트에서 컨텍스트는 콘텐츠를 담은 그 무엇인가를 뜻한다. 물컵에 물이 담겨있는 예시를 들어보면 물이 담겨있는 물은 콘텐츠고 물컵은 컨텍스트라고 볼 수 있다.

```swift
let optionalString: String? = "Hello, world!"

let transformedOptionalString = optionalString.flatMap { string in
    return Optional("\(string.count)")
}

print(transformedOptionalString) // Optional("13")
```

문자열의 길이를 Int형으로 바꿔주는 코드.

# 메모리 안전

### 메모리 접근 충돌

- 메모리 접근 충돌은 서로 다른 코드에서 동시에 같은 위치의 메모리에 접근할 때 발생한다.

```swift
// one이 저장도리 메모리 위치에 쓰기 접근
var one: Int = 1

//one이 저장된 메모리 위치에 읽기 접근
print("숫자 출력 : \(one)")
```

### 메모리 접근의 특성

메모리 접근이 두 군데 이상의 코드에서 동시에 일어나면 메모리 접근 충돌이 발생한다.

- 최소한 한 곳에서 쓰기 접근한다.
- 같은 메모리 위치에 접근한다.
- 접근 타이밍이 겹친다.

순차적으로 코드를 실행하고, 메모리에 접근하는 것이 **순간적**이라면 다른  코드에서 같은 메모리 위치에 동시에 접근할 일이 없다. 

**장기적** 메모리 접근이라는 접근 방식도 있다. 장기적 메모리 접근 중에는 해당 메모리 접근이 끝나기 전에 다른 코드에서 메모리에 접근할 가능성이 있다.